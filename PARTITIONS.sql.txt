select DISTINCT 
FIRST_VALUE (analytic_data.name) over comunna as 'Community name',
AVG(analytic_data.total) over () as 'total all',
FIRST_VALUE (analytic_data.fullname) over birthday_young as 'youngest_name',
FIRST_VALUE (analytic_data.birthday) over birthday_young as 'youngest_birth',
FIRST_VALUE (analytic_data.fullname) over birthday_old as 'oldest_name',
FIRST_VALUE (analytic_data.birthday) over birthday_old as 'oldest_birth',
FIRST_VALUE (analytic_data.total) over comunna as 'total in group',
(select count(users.profile_id) from users) as 'allusers',
(FIRST_VALUE (analytic_data.total) over comunna) / (select count(users.profile_id) from users) * 100 as '%%'
from 
(select 
c.name , 
c.profile_id,
cu.user_profile_id ,
CONCAT_WS(' ',u.first_name,u.last_name) as fullname,
u.birthday,
COUNT(cu.user_profile_id) OVER (PARTITION BY c.profile_id) as total
from communities c 
join communities_users cu 
on c.profile_id  = cu.community_profile_id 
join users u 
on cu.user_profile_id  = u.profile_id 
where cu.status_id  = 6) as analytic_data
window comunna as (PARTITION BY profile_id),
birthday_old as (comunna ORDER BY birthday ASC),
birthday_young as (comunna ORDER BY birthday DESC);